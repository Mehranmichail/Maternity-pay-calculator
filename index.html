<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SMP Calculator ‚Äî Production (2025-26 rates)</title>
  <style>
    /* Responsive, clean UI (keeps your original look but adds new inputs) */
    :root{--accent1:#667eea;--accent2:#764ba2;--card:#ffffff;--muted:#666}
    *{box-sizing:border-box}
    body{font-family:Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(135deg,#eef2ff 0%, #f7f3ff 100%);margin:0;padding:20px}
    .container{max-width:980px;margin:0 auto;background:var(--card);border-radius:14px;box-shadow:0 12px 30px rgba(0,0,0,.12);overflow:hidden}
    .header{background:linear-gradient(135deg,var(--accent1),var(--accent2));color:#fff;padding:28px;text-align:center}
    .header h1{margin:0;font-size:22px}
    .content{padding:26px}
    .section{margin-bottom:20px}
    label{display:block;font-weight:600;margin-bottom:8px}
    input[type="number"], input[type="date"], select{width:100%;padding:10px;border-radius:8px;border:1px solid #ddd;font-size:15px}
    .grid{display:grid;gap:10px}
    .grid.cols-4{grid-template-columns:repeat(4,1fr)}
    .grid.cols-2{grid-template-columns:repeat(2,1fr)}
    .small{font-size:13px;color:var(--muted)}
    .btn{background:linear-gradient(135deg,var(--accent1),var(--accent2));color:#fff;padding:14px;border:none;border-radius:10px;font-weight:700;font-size:16px;cursor:pointer;width:100%}
    .results{display:none;margin-top:18px}
    .card{border-radius:10px;padding:18px;border:1px solid #e6e6e6;background:#fff;margin-bottom:12px}
    .pass{border-left:4px solid #4caf50}
    .fail{border-left:4px solid #f44336}
    .pay-row{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:8px;background:linear-gradient(135deg,#f0f4ff,#f8f7ff);margin-bottom:8px}
    .total{background:linear-gradient(135deg,var(--accent1),var(--accent2));color:#fff;padding:14px;border-radius:8px;text-align:center;font-weight:700}
    .footer{background:#f5f5f5;padding:14px;text-align:center;font-size:13px;color:#444}
    @media(max-width:720px){.grid.cols-4{grid-template-columns:repeat(2,1fr)}}
  </style>
</head>
<body>
  <div class="container" role="main">
    <div class="header">
      <h1>ü§∞ UK Statutory Maternity Pay (SMP) Calculator ‚Äî 2025‚Äì26</h1>
      <div class="small">Configured using GOV.UK published 2025‚Äì26 rates (standard rate ¬£187.18; qualifying weekly minimum ¬£125.00). :contentReference[oaicite:1]{index=1}</div>
    </div>

    <div class="content">
      <div class="section card">
        <strong>Input</strong>
        <div style="margin-top:12px" class="grid cols-2">
          <div>
            <label for="dueDate">Expected Due Date</label>
            <input id="dueDate" type="date" />
          </div>
          <div>
            <label for="employmentStart">Employment Start Date</label>
            <input id="employmentStart" type="date" />
          </div>
        </div>

        <div style="margin-top:12px">
          <label for="payFrequency">Pay Frequency</label>
          <select id="payFrequency">
            <option value="">Select pay frequency‚Ä¶</option>
            <option value="weekly">Weekly</option>
            <option value="fortnightly">Fortnightly (every 2 weeks)</option>
            <option value="4-weekly">4-weekly</option>
            <option value="monthly">Monthly</option>
          </select>
          <div class="small" style="margin-top:8px">Choose the pay frequency that matches how the employee is paid. The calculator will show the required pay-entry fields for that frequency.</div>
        </div>
      </div>

      <!-- Earnings inputs (all present; JS will show/hide as needed) -->
      <div class="section card">
        <strong>Earnings ‚Äî enter gross pay for each recent pay period</strong>
        <div class="small" style="margin-top:8px">For weekly: enter 8 most recent weekly gross pays. For fortnightly: 4 most recent pays. For 4-weekly: 2 pays. For monthly: 2 most recent months. Leave fields blank that don't apply.</div>

        <div id="weeklyInputs" style="margin-top:14px;display:none">
          <label>Weekly paid ‚Äî last 8 weeks (gross ¬£)</label>
          <div class="grid cols-4" id="weeklyGrid">
            <input id="w1" type="number" step="0.01" min="0" placeholder="Week 1" />
            <input id="w2" type="number" step="0.01" min="0" placeholder="Week 2" />
            <input id="w3" type="number" step="0.01" min="0" placeholder="Week 3" />
            <input id="w4" type="number" step="0.01" min="0" placeholder="Week 4" />
            <input id="w5" type="number" step="0.01" min="0" placeholder="Week 5" />
            <input id="w6" type="number" step="0.01" min="0" placeholder="Week 6" />
            <input id="w7" type="number" step="0.01" min="0" placeholder="Week 7" />
            <input id="w8" type="number" step="0.01" min="0" placeholder="Week 8" />
          </div>
        </div>

        <div id="fortnightlyInputs" style="margin-top:14px;display:none">
          <label>Fortnightly paid ‚Äî last 4 pays (gross ¬£)</label>
          <div class="grid cols-2" id="fnGrid">
            <input id="fn1" type="number" step="0.01" min="0" placeholder="Fortnight 1" />
            <input id="fn2" type="number" step="0.01" min="0" placeholder="Fortnight 2" />
            <input id="fn3" type="number" step="0.01" min="0" placeholder="Fortnight 3" />
            <input id="fn4" type="number" step="0.01" min="0" placeholder="Fortnight 4" />
          </div>
        </div>

        <div id="fourWeeklyInputs" style="margin-top:14px;display:none">
          <label>4-weekly paid ‚Äî last 2 pays (gross ¬£)</label>
          <div class="grid cols-2" id="fourGrid">
            <input id="four1" type="number" step="0.01" min="0" placeholder="4-week pay 1" />
            <input id="four2" type="number" step="0.01" min="0" placeholder="4-week pay 2" />
          </div>
        </div>

        <div id="monthlyInputs" style="margin-top:14px;display:none">
          <label>Monthly paid ‚Äî last 2 months (gross ¬£)</label>
          <div class="grid cols-2" id="monthlyGrid">
            <input id="m1" type="number" step="0.01" min="0" placeholder="Month 1" />
            <input id="m2" type="number" step="0.01" min="0" placeholder="Month 2" />
          </div>
        </div>
      </div>

      <div class="section">
        <button id="smpCalcButton" class="btn">Calculate Maternity Pay</button>
      </div>

      <div id="results" class="results" aria-live="polite"></div>

      <div class="footer">
        <div>Disclaimer: guidance only ‚Äî always verify with GOV.UK/HMRC official pages. Rates used are the GOV.UK 2025‚Äì26 figures. :contentReference[oaicite:2]{index=2}</div>
      </div>
    </div>
  </div>

  <!-- SCRIPT: accurate SMP logic (qualifying week, AWE, continuous employment) -->
  <script>
  (function () {
    'use strict';

    // --- CONFIG (update if HMRC changes) ---
    var SMP_STANDARD_RATE = 187.18; // weeks 7-39 standard weekly rate (GOV.UK 2025-26)
    var SMP_LEL = 125.00; // Lower Earnings Limit / minimum average weekly earnings for eligibility (2025-26)
    var TOTAL_SMP_WEEKS = 39;
    var FIRST_6_WEEKS = 6;
    var REMAINING_WEEKS = TOTAL_SMP_WEEKS - FIRST_6_WEEKS;

    // Utility: zero time (use UTC to avoid timezone shifts)
    function startOfDayUTC(date) {
      var d = new Date(date.getTime());
      d.setUTCHours(0,0,0,0);
      return d;
    }

    // Returns the Sunday on or before the given date (EWC start as HMRC defines)
    function sundayOnOrBefore(date) {
      var d = startOfDayUTC(new Date(date));
      var dow = d.getUTCDay(); // 0 = Sunday
      d.setUTCDate(d.getUTCDate() - dow);
      return startOfDayUTC(d);
    }

    // Compute qualifying week start/end: 15 weeks BEFORE EWC_start
    function qualifyingWeekForDueDate(dueDate) {
      var ewcStart = sundayOnOrBefore(new Date(dueDate));
      var qStart = new Date(ewcStart.getTime() - 15 * 7 * 24 * 60 * 60 * 1000); // 15 weeks earlier
      var qEnd = new Date(qStart.getTime() + 6 * 24 * 60 * 60 * 1000);
      return { qStart: startOfDayUTC(qStart), qEnd: startOfDayUTC(qEnd), ewcStart: ewcStart };
    }

    // Convert numeric arrays to average weekly earnings by frequency
    function computeAWE(entries, freq) {
      // entries should be numbers (non-empty). If some blank, call will only include present entries.
      var sum = entries.reduce(function (s, v) { return s + v; }, 0);
      var pays = entries.length;
      if (pays === 0) return { avgWeekly: 0, usedPeriods: 0, weeksCovered: 0 };

      if (freq === 'weekly') {
        var weeksCovered = pays;
        return { avgWeekly: sum / weeksCovered, usedPeriods: pays, weeksCovered: weeksCovered };
      } else if (freq === 'fortnightly') {
        var weeksCovered = pays * 2;
        return { avgWeekly: sum / weeksCovered, usedPeriods: pays, weeksCovered: weeksCovered };
      } else if (freq === '4-weekly') {
        var weeksCovered = pays * 4;
        return { avgWeekly: sum / weeksCovered, usedPeriods: pays, weeksCovered: weeksCovered };
      } else if (freq === 'monthly') {
        // HMRC: monthly -> average weekly = (monthly average * 12) / 52
        var monthlyAvg = sum / pays;
        var avgWeekly = (monthlyAvg * 12) / 52;
        return { avgWeekly: avgWeekly, usedPeriods: pays, weeksCovered: (pays * (52/12)) };
      } else {
        var weeksCovered = pays;
        return { avgWeekly: sum / weeksCovered, usedPeriods: pays, weeksCovered: weeksCovered };
      }
    }

    // Required pay entries for accuracy (GOV.UK typical guidance: use last ~8 weeks or whole pay periods)
    var REQUIRED_ENTRIES = {
      'weekly': 8,
      'fortnightly': 4,
      '4-weekly': 2,
      'monthly': 2
    };

    // UI helpers
    var payFrequencyEl = document.getElementById('payFrequency');
    var weeklyInputs = document.getElementById('weeklyInputs');
    var fortnightlyInputs = document.getElementById('fortnightlyInputs');
    var fourWeeklyInputs = document.getElementById('fourWeeklyInputs');
    var monthlyInputs = document.getElementById('monthlyInputs');
    var resultsEl = document.getElementById('results');

    function hideAllEarnings() {
      weeklyInputs.style.display = 'none';
      fortnightlyInputs.style.display = 'none';
      fourWeeklyInputs.style.display = 'none';
      monthlyInputs.style.display = 'none';
    }

    payFrequencyEl && payFrequencyEl.addEventListener('change', function () {
      hideAllEarnings();
      var v = payFrequencyEl.value;
      if (v === 'weekly') weeklyInputs.style.display = 'block';
      else if (v === 'fortnightly') fortnightlyInputs.style.display = 'block';
      else if (v === '4-weekly') fourWeeklyInputs.style.display = 'block';
      else if (v === 'monthly') monthlyInputs.style.display = 'block';
      // clear results when user changes frequency
      resultsEl.style.display = 'none';
      resultsEl.innerHTML = '';
    });

    function formatDate(d) {
      return new Date(d).toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' });
    }

    function gbp(n) { return parseFloat(n).toFixed(2); }

    // Calculation handler
    var calcBtn = document.getElementById('smpCalcButton');
    calcBtn && calcBtn.addEventListener('click', function () {
      try {
        var dueDateVal = document.getElementById('dueDate').value;
        var empStartVal = document.getElementById('employmentStart').value;
        var freq = (document.getElementById('payFrequency') && document.getElementById('payFrequency').value) || '';

        if (!dueDateVal || !empStartVal || !freq) {
          alert('Please fill due date, employment start date and select pay frequency.');
          return;
        }

        var q = qualifyingWeekForDueDate(new Date(dueDateVal));
        var qStart = q.qStart, qEnd = q.qEnd;

        // gather entries depending on frequency
        var entries = [];
        if (freq === 'weekly') {
          for (var i=1;i<=8;i++){
            var el = document.getElementById('w'+i);
            if (el && el.value !== '') entries.push(parseFloat(el.value));
          }
        } else if (freq === 'fortnightly') {
          for (var i=1;i<=4;i++){
            var el = document.getElementById('fn'+i);
            if (el && el.value !== '') entries.push(parseFloat(el.value));
          }
        } else if (freq === '4-weekly') {
          for (var i=1;i<=2;i++){
            var el = document.getElementById('four'+i);
            if (el && el.value !== '') entries.push(parseFloat(el.value));
          }
        } else if (freq === 'monthly') {
          for (var i=1;i<=2;i++){
            var el = document.getElementById('m'+i);
            if (el && el.value !== '') entries.push(parseFloat(el.value));
          }
        }

        var required = REQUIRED_ENTRIES[freq] || 2;
        if (entries.length < required) {
          alert('Please enter at least ' + required + ' pay period entries for accurate calculation for ' + freq + ' pay. You entered ' + entries.length + '.');
          return;
        }

        // compute AWE
        var aweObj = computeAWE(entries, freq);
        var avgWeekly = aweObj.avgWeekly;
        var earnPassed = avgWeekly >= SMP_LEL;

        // continuous employment: employee must have started on or before (qualifyingWeekEnd - 26 weeks)
        var empStart = startOfDayUTC(new Date(empStartVal));
        var requiredStartDate = startOfDayUTC(new Date(qEnd.getTime() - 26 * 7 * 24 * 60 * 60 * 1000));
        var empPassed = empStart <= requiredStartDate;

        // SMP calculation
        var rate90 = avgWeekly * 0.90;
        var first6Rate = rate90; // no cap for first 6 weeks (90% of AWE)
        var remainingRate = Math.min(SMP_STANDARD_RATE, rate90);
        var totalFirst6 = first6Rate * FIRST_6_WEEKS;
        var totalRemaining = remainingRate * REMAINING_WEEKS;
        var totalSMP = totalFirst6 + totalRemaining;

        var eligible = empPassed && earnPassed;

        // Build output HTML
        var html = '<div class="card ' + (eligible ? 'pass' : 'fail') + '">';
        html += '<div style="display:flex;align-items:center;gap:12px;margin-bottom:12px"><div style="font-size:28px">' + (eligible ? '‚úÖ' : '‚ùå') + '</div>';
        html += '<div><strong style="font-size:16px">' + (eligible ? 'Eligible for SMP' : 'Not eligible for SMP') + '</strong><div class="small">Based on the information you provided</div></div></div>';

        html += '<div style="margin-bottom:12px"><strong>Due Date:</strong> ' + formatDate(dueDateVal) + '<br>';
        html += '<strong>Qualifying week:</strong> ' + formatDate(qStart) + ' to ' + formatDate(qEnd) + '</div>';

        html += '<div style="margin:10px 0;font-weight:600">Eligibility checks</div>';

        html += '<div class="card ' + (empPassed ? 'pass' : 'fail') + '">';
        html += '<div style="display:flex;justify-content:space-between;align-items:center"><div><div class="small" style="font-weight:600">Continuous employment</div>';
        html += '<div class="small">Employment must have started on or before ' + formatDate(requiredStartDate) + '</div></div>';
        html += '<div style="font-weight:700">' + (empPassed ? 'PASS' : 'FAIL') + '</div></div></div>';

        html += '<div class="card ' + (earnPassed ? 'pass' : 'fail') + '">';
        html += '<div style="display:flex;justify-content:space-between;align-items:center"><div><div class="small" style="font-weight:600">Average weekly earnings (minimum ¬£' + SMP_LEL.toFixed(2) + ')</div>';
        html += '<div class="small">Average weekly earnings: ¬£' + gbp(avgWeekly) + ' (based on ' + aweObj.usedPeriods + ' pay period(s))</div></div>';
        html += '<div style="font-weight:700">' + (earnPassed ? 'PASS' : 'FAIL') + '</div></div></div>';

        if (eligible) {
          html += '<div class="card" style="background:linear-gradient(135deg,#f9fbff,#fff)">';
          html += '<div style="font-weight:700;margin-bottom:8px">üí∑ SMP payment breakdown</div>';
          html += '<div class="pay-row"><div><div class="small">Weeks 1-' + FIRST_6_WEEKS + ' (90% of AWE)</div></div><div>¬£' + gbp(first6Rate) + '/week<br><span class="small">Total ¬£' + gbp(totalFirst6) + '</span></div></div>';
          html += '<div class="pay-row"><div><div class="small">Weeks ' + (FIRST_6_WEEKS+1) + '-' + TOTAL_SMP_WEEKS + ' (lower of ¬£' + SMP_STANDARD_RATE.toFixed(2) + ' or 90% of AWE)</div></div><div>¬£' + gbp(remainingRate) + '/week<br><span class="small">Total ¬£' + gbp(totalRemaining) + '</span></div></div>';
          html += '<div class="total" style="margin-top:10px">Estimated total SMP (39 weeks): ¬£' + gbp(totalSMP) + '</div>';
          html += '<div class="small" style="margin-top:10px">Note: SMP is subject to tax & National Insurance. Employer may include contractual pay ‚Äî this is the statutory entitlement calculation.</div>';
          html += '</div>';
        } else {
          html += '<div class="card"><div class="small">You may qualify for <strong>Maternity Allowance</strong> if you don‚Äôt meet SMP tests ‚Äî see GOV.UK for rules.</div></div>';
        }

        html += '</div>'; // outer card end

        resultsEl.innerHTML = html;
        resultsEl.style.display = 'block';
        resultsEl.scrollIntoView({ behavior: 'smooth' });

      } catch (err) {
        console.error(err);
        alert('Calculation error. Please check inputs.');
      }
    });
  })();
  </script>
</body>
</html>
